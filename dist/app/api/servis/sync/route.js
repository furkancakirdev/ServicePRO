(()=>{var e={};e.id=635,e.ids=[635],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},68621:e=>{"use strict";e.exports=require("punycode")},86624:e=>{"use strict";e.exports=require("querystring")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},15673:e=>{"use strict";e.exports=require("node:events")},97742:e=>{"use strict";e.exports=require("node:process")},47261:e=>{"use strict";e.exports=require("node:util")},87529:()=>{},85195:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>E,patchFetch:()=>R,requestAsyncStorage:()=>f,routeModule:()=>A,serverHooks:()=>q,staticGenerationAsyncStorage:()=>k});var s={};r.r(s),r.d(s,{GET:()=>x,POST:()=>h});var i=r(49303),a=r(88716),n=r(60670),o=r(87070),u=r(97816),l=r(33064),c=r(72331);let d={"PLANLANDI-RANDEVU":"RANDEVU_VERILDI","DEVAM EDÄ°YOR":"DEVAM_EDÄ°YOR",TAMAMLANDI:"TAMAMLANDI","PARCA BEKLIYOR":"PARCA_BEKLIYOR","M\xdcÅžTERÄ° ONAY BEKLIYOR":"MUSTERI_ONAY_BEKLIYOR"};async function p(){let e=new l.GoogleAuth({credentials:{client_email:process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL,private_key:process.env.GOOGLE_PRIVATE_KEY?.replace(/\\n/g,"\n")},scopes:["https://www.googleapis.com/auth/spreadsheets"]});return u.lkr.sheets({version:"v4",auth:e})}async function v(){let e=await p(),t=(await e.spreadsheets.values.get({spreadsheetId:"1IGa23ZXugvCGblp4GtE2Tl06Z2mnZ2VxIM_F6vyolVs",range:`At\xf6lye Servis Planlama!A:J`})).data.values||[];return t.length<=1?[]:t.slice(1).map((e,t)=>{let r=e[0]||String(2720+t);return e.slice(1).some(e=>e&&""!==e.toString().trim())?{id:r,tarih:e[1]||null,saat:e[2]||null,tekneAdi:e[3]||"",adres:e[4]||"",yer:e[5]||"",servisAciklamasi:e[6]||"",irtibatKisi:e[7]||null,telefon:e[8]||null,durum:d[e[9]]||"RANDEVU_VERILDI"}:null}).filter(Boolean)}async function y(e){let t=new Map;return e.forEach(e=>{let r=e.tekneAdi.trim();r&&!t.has(r)&&t.set(r,{ad:r,adres:e.adres,aktif:!0})}),Array.from(t.values())}async function m(){console.log("\uD83D\uDD04 Google Sheets'ten veri \xe7ekiliyor...");let e=await v();console.log(`ðŸ“Š ${e.length} servis kaydÄ± bulundu`);let t=await y(e);console.log(`ðŸ›¥ï¸ ${t.length} benzersiz tekne tespit edildi`);let r=0;for(let e of t){let t=await c._.tekne.findFirst({where:{ad:e.ad}});t?await c._.tekne.update({where:{id:t.id},data:{}}):await c._.tekne.create({data:e}),r++}console.log(`âœ… ${r} tekne veritabanÄ±na kaydedildi`);let s=0,i=0;for(let t of e){if(!t)continue;let e=await c._.tekne.findFirst({where:{ad:t.tekneAdi}});if(!e){console.warn(`âš ï¸ Tekne bulunamadÄ±: ${t.tekneAdi}`);continue}let r=null;if(t.tarih){let[e,s,i]=t.tarih.split(".");r=new Date(`${i}-${s}-${e}`)}let a=await c._.service.findUnique({where:{id:t.id}}),n={id:t.id,tarih:r,saat:t.saat,tekneId:e.id,tekneAdi:e.ad,adres:t.adres,yer:t.yer,servisAciklamasi:t.servisAciklamasi,irtibatKisi:t.irtibatKisi,telefon:t.telefon,durum:t.durum,isTuru:"PAKET"};a?(await c._.service.update({where:{id:t.id},data:n}),i++):(await c._.service.create({data:n}),s++)}return console.log(`âœ… ${s} yeni servis oluÅŸturuldu`),console.log(`ðŸ”„ ${i} servis g\xfcncellendi`),{toplamServis:e.length,tekneler:r,yeniServis:s,guncellenenServis:i}}async function g(){return console.log("\uD83D\uDD04 \xc7ift y\xf6nl\xfc senkronizasyon baÅŸlÄ±yor..."),await m()}async function h(e){try{console.log("\uD83D\uDD04 Manuel senkronizasyon baÅŸlatÄ±lÄ±yor...");let e=await g();return o.NextResponse.json({success:!0,data:e,message:"Senkronizasyon baÅŸarÄ±yla tamamlandÄ±"})}catch(e){return console.error("âŒ Senkronizasyon hatasÄ±:",e),o.NextResponse.json({success:!1,error:{code:"SYNC_ERROR",message:"Senkronizasyon sÄ±rasÄ±nda hata oluÅŸtu",details:e.message}},{status:500})}}async function x(){try{return o.NextResponse.json({success:!0,data:{status:"ready",spreadsheetId:"1IGa23ZXugvCGblp4GtE2Tl06Z2mnZ2VxIM_F6vyolVs",sheetName:"At\xf6lye Servis Planlama",lastSync:new Date().toISOString()},message:"Senkronizasyon servisi hazÄ±r"})}catch(e){return o.NextResponse.json({success:!1,error:{code:"STATUS_ERROR",message:"Durum sorgulanamadÄ±",details:e.message}},{status:500})}}let A=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/servis/sync/route",pathname:"/api/servis/sync",filename:"route",bundlePath:"app/api/servis/sync/route"},resolvedPagePath:"C:\\Users\\furkan.cakir\\Desktop\\ServicePro\\ServicePro_Demo\\app\\api\\servis\\sync\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:k,serverHooks:q}=A,E="/api/servis/sync/route";function R(){return(0,n.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:k})}},72331:(e,t,r)=>{"use strict";r.d(t,{_:()=>i});var s=r(53524);let i=global.prisma||new s.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,7816],()=>r(85195));module.exports=s})();