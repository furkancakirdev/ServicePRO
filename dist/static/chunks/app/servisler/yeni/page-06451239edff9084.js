(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{1035:function(e,t,i){Promise.resolve().then(i.bind(i,7650))},7650:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return c}});var r=i(7437),o=i(2265),a=i(9376),n=i(9501),l=i(3590),s=i(5897),d=i(6942);let p=s.Ryn({tekneId:s.Z_8().min(1,"Tekne se\xe7iniz"),tarih:s.Z_8().min(1,"Tarih giriniz"),saat:s.Z_8().optional(),isTuru:s.KmV(["PAKET","ARIZA","PROJE"]),adres:s.Z_8().min(1,"Adres giriniz"),yer:s.Z_8().min(1,"Lokasyon giriniz"),servisAciklamasi:s.Z_8().min(5,"Servis a\xe7ıklaması en az 5 karakter olmalı"),irtibatKisi:s.Z_8().optional(),telefon:s.Z_8().optional(),durum:s.KmV(["RANDEVU_VERILDI","DEVAM_EDIYOR","PARCA_BEKLIYOR","MUSTERI_ONAY_BEKLIYOR","RAPOR_BEKLIYOR","KESIF_KONTROL","TAMAMLANDI"]),taseronNotlari:s.Z_8().optional()});function c(){let e=(0,a.useRouter)(),{user:t,isAuthenticated:i}=(0,d.a)(),[s,c]=(0,o.useState)([]),[x,u]=(0,o.useState)([]),[f,h]=(0,o.useState)(!0),[g,m]=(0,o.useState)(!1),[b,y]=(0,o.useState)(""),{register:k,handleSubmit:j,formState:{errors:v}}=(0,n.cI)({resolver:(0,l.F)(p),defaultValues:{tekneId:"",tarih:new Date().toISOString().split("T")[0],durum:"RANDEVU_VERILDI",isTuru:"PAKET"}});(0,o.useEffect)(()=>{let e=async()=>{try{let[e,t]=await Promise.all([fetch("/api/tekneler"),fetch("/api/personel")]);if(e.ok){let t=await e.json();c(t)}if(t.ok){let e=await t.json();u(e)}}catch(e){console.error("Veri y\xfcklenemedi:",e)}finally{h(!1)}};i&&e()},[i]),(0,o.useEffect)(()=>{i||f||e.push("/login")},[i,f,e]);let S=async i=>{m(!0),y("");try{var r;let o=await fetch("/api/services",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({...i,tekneAdi:(null===(r=s.find(e=>e.id===i.tekneId))||void 0===r?void 0:r.ad)||"",userId:null==t?void 0:t.id,userEmail:null==t?void 0:t.email})});if(!o.ok){let e=await o.json();throw Error(e.error||"Servis oluşturulamadı")}e.push("/servisler")}catch(e){y(e instanceof Error?e.message:"Bir hata oluştu"),m(!1)}};return f?(0,r.jsx)("div",{style:{padding:"40px",textAlign:"center"},children:"Y\xfckleniyor..."}):(0,r.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,r.jsx)("h1",{style:{fontSize:"28px",fontWeight:700,marginBottom:"8px"},children:"Yeni Servis"}),(0,r.jsx)("p",{style:{color:"var(--color-text-muted)"},children:"Yeni servis kaydı oluşturun"})]}),b&&(0,r.jsxs)("div",{style:{padding:"16px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid #ef4444",borderRadius:"8px",color:"#ef4444",marginBottom:"24px"},children:["⚠️ ",b]}),(0,r.jsxs)("form",{onSubmit:j(S),style:{background:"rgba(255, 255, 255, 0.03)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"32px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,r.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:["Tekne ",(0,r.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,r.jsxs)("select",{...k("tekneId"),style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"},children:[(0,r.jsx)("option",{value:"",children:"Tekne Se\xe7in"}),s.map(e=>(0,r.jsx)("option",{value:e.id,children:e.ad},e.id))]}),v.tekneId&&(0,r.jsx)("span",{style:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},children:v.tekneId.message})]}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"24px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:["Tarih ",(0,r.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,r.jsx)("input",{type:"date",...k("tarih"),style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"}}),v.tarih&&(0,r.jsx)("span",{style:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},children:v.tarih.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"Saat"}),(0,r.jsx)("input",{type:"time",...k("saat"),style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"}})]})]}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"24px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"İş T\xfcr\xfc"}),(0,r.jsxs)("select",{...k("isTuru"),style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"},children:[(0,r.jsx)("option",{value:"PAKET",children:"Paket İş"}),(0,r.jsx)("option",{value:"ARIZA",children:"Arıza / Keşif"}),(0,r.jsx)("option",{value:"PROJE",children:"Proje / Refit"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"Durum"}),(0,r.jsxs)("select",{...k("durum"),style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"},children:[(0,r.jsx)("option",{value:"RANDEVU_VERILDI",children:"Randevu Verildi"}),(0,r.jsx)("option",{value:"DEVAM_EDIYOR",children:"Devam Ediyor"}),(0,r.jsx)("option",{value:"PARCA_BEKLIYOR",children:"Par\xe7a Bekliyor"}),(0,r.jsx)("option",{value:"MUSTERI_ONAY_BEKLIYOR",children:"M\xfcşteri Onay Bekliyor"}),(0,r.jsx)("option",{value:"RAPOR_BEKLIYOR",children:"Rapor Bekliyor"}),(0,r.jsx)("option",{value:"KESIF_KONTROL",children:"Keşif-Kontrol"}),(0,r.jsx)("option",{value:"TAMAMLANDI",children:"Tamamlandı"})]})]})]}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"16px",marginBottom:"24px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:["Adres ",(0,r.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,r.jsx)("input",{type:"text",...k("adres"),placeholder:"Teknenin bulunduğu adres",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"}}),v.adres&&(0,r.jsx)("span",{style:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},children:v.adres.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:["Lokasyon ",(0,r.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,r.jsx)("input",{type:"text",...k("yer"),placeholder:"Yatmarin / Netsel / Dış",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"}}),v.yer&&(0,r.jsx)("span",{style:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},children:v.yer.message})]})]}),(0,r.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,r.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:["Servis A\xe7ıklaması ",(0,r.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,r.jsx)("textarea",{...k("servisAciklamasi"),rows:4,placeholder:"Servisin detaylı a\xe7ıklaması...",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff",resize:"vertical"}}),v.servisAciklamasi&&(0,r.jsx)("span",{style:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},children:v.servisAciklamasi.message})]}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"24px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"İrtibat Kişi"}),(0,r.jsx)("input",{type:"text",...k("irtibatKisi"),placeholder:"M\xfcşteri yetkilisi",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"Telefon"}),(0,r.jsx)("input",{type:"tel",...k("telefon"),placeholder:"Telefon numarası",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff"}})]})]}),(0,r.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"Taşeron Notları"}),(0,r.jsx)("textarea",{...k("taseronNotlari"),rows:2,placeholder:"Taşeron varsa notlar...",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff",resize:"vertical"}})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end"},children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.back(),disabled:g,style:{padding:"12px 24px",background:"transparent",color:"var(--color-text-muted)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",cursor:"pointer",fontWeight:500},children:"İptal"}),(0,r.jsx)("button",{type:"submit",disabled:g,style:{padding:"12px 32px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:"8px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.5:1},children:g?"Kaydediliyor...":"Servis Oluştur"})]})]})]})}},3909:function(e,t,i){"use strict";i.d(t,{AuthProvider:function(){return n},a:function(){return l}});var r=i(7437),o=i(2265);let a=(0,o.createContext)(void 0);function n(e){let{children:t}=e,[i,n]=(0,o.useState)(null),[l,s]=(0,o.useState)(!0);async function d(){try{let e=null;if(!(e=localStorage.getItem("token"))){let t=document.cookie.match(/(^|;) ?token=([^;]*)(;|$)/);(e=t?t[2]:null)&&localStorage.setItem("token",e)}if(!e){s(!1);return}let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e.user)}else localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax",n(null)}catch(e){console.error("Auth check failed:",e),n(null)}finally{s(!1)}}async function p(e,t){let i=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!i.ok)throw Error((await i.json()).error||"Giriş başarısız");let r=await i.json();n(r.user),localStorage.setItem("token",r.token),document.cookie="token=".concat(r.token,"; path=/; max-age=").concat(604800,"; SameSite=Lax")}async function c(){await d()}return(0,o.useEffect)(()=>{d()},[]),(0,r.jsx)(a.Provider,{value:{user:i,isAuthenticated:!!i,isLoading:l,login:p,logout:function(){n(null),localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax",fetch("/api/auth/logout",{method:"POST"}).catch(e=>console.error("Logout API error:",e))},refreshUser:c},children:t})}function l(){let e=(0,o.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},6942:function(e,t,i){"use strict";i.d(t,{a:function(){return r.a}});var r=i(3909)}},function(e){e.O(0,[775,971,117,744],function(){return e(e.s=1035)}),_N_E=e.O()}]);