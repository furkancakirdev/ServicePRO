(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6493:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),i=r(2265),o=r(9376),n=r(9501),s=r(3590),l=r(5897),c=r(6942);let d=l.Ryn({email:l.Z_8().email("Ge\xe7ersiz e-posta formatı"),password:l.Z_8().min(1,"Şifre gerekli"),rememberMe:l.O72().optional()});function m(){let e=(0,o.useRouter)(),t=(0,o.useSearchParams)(),{login:r,isAuthenticated:l}=(0,c.a)(),[m,u]=(0,i.useState)(""),[p,h]=(0,i.useState)(!1),{register:f,handleSubmit:v,formState:{errors:x}}=(0,n.cI)({resolver:(0,s.F)(d),defaultValues:{email:"",password:"",rememberMe:!1}});(0,i.useEffect)(()=>{if(l){let r=t.get("redirect")||"/";e.push(r)}},[l,e,t]);let g=async e=>{u(""),h(!0);try{await r(e.email,e.password);let a=t.get("redirect")||"/";window.location.href=a}catch(e){u(e instanceof Error?e.message:"Giriş başarısız"),h(!1)}};return(0,a.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, var(--color-bg) 0%, #1a1a2e 100%)"},children:(0,a.jsxs)("div",{className:"card",style:{width:"100%",maxWidth:"400px",padding:"var(--space-2xl)"},children:[(0,a.jsxs)("div",{style:{textAlign:"center",marginBottom:"var(--space-xl)"},children:[(0,a.jsx)("div",{style:{fontSize:"3rem",marginBottom:"var(--space-md)"},children:"⚓"}),(0,a.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:700},children:"ServicePRO"}),(0,a.jsx)("p",{style:{color:"var(--color-text-muted)",fontSize:"0.85rem"},children:"Tekne Teknik Servis Takip Sistemi"})]}),m&&(0,a.jsxs)("div",{style:{padding:"var(--space-md)",background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--color-error)",borderRadius:"var(--radius-md)",color:"var(--color-error)",marginBottom:"var(--space-lg)",fontSize:"0.85rem"},children:["⚠️ ",m]}),(0,a.jsxs)("form",{onSubmit:v(g),children:[(0,a.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"var(--space-xs)",fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"E-posta"}),(0,a.jsx)("input",{type:"email",className:"form-input",placeholder:"ornek@servicepro.com",...f("email"),style:{width:"100%"},"aria-invalid":x.email?"true":"false"}),x.email&&(0,a.jsx)("span",{style:{color:"var(--color-error)",fontSize:"0.75rem",display:"block",marginTop:"var(--space-xs)"},children:x.email.message})]}),(0,a.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"var(--space-xs)",fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Şifre"}),(0,a.jsx)("input",{type:"password",className:"form-input",placeholder:"••••••••",...f("password"),style:{width:"100%"},"aria-invalid":x.password?"true":"false"}),x.password&&(0,a.jsx)("span",{style:{color:"var(--color-error)",fontSize:"0.75rem",display:"block",marginTop:"var(--space-xs)"},children:x.password.message})]}),(0,a.jsx)("div",{style:{marginBottom:"var(--space-xl)"},children:(0,a.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,a.jsx)("input",{type:"checkbox",...f("rememberMe"),style:{marginRight:"var(--space-xs)"}}),(0,a.jsx)("span",{style:{fontSize:"0.85rem"},children:"Beni hatırla"})]})}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,style:{width:"100%",padding:"var(--space-md)",fontSize:"1rem"},children:p?"⏳ Giriş yapılıyor...":"\uD83D\uDD10 Giriş Yap"})]}),(0,a.jsxs)("div",{style:{marginTop:"var(--space-xl)",padding:"var(--space-md)",background:"var(--color-surface-elevated)",borderRadius:"var(--radius-md)",fontSize:"0.75rem"},children:[(0,a.jsx)("div",{style:{color:"var(--color-text-muted)",marginBottom:"var(--space-xs)"},children:"Demo Giriş Bilgileri:"}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--space-xs)"},children:[(0,a.jsx)("span",{children:"Admin:"}),(0,a.jsx)("code",{children:"admin@servicepro.com / admin123"})]}),(0,a.jsx)("div",{style:{fontSize:"0.7rem",color:"var(--color-text-muted)"},children:"(\xd6nce veritabanına admin kullanıcısı ekleyin)"})]})]})})}function u(){return(0,a.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, var(--color-bg) 0%, #1a1a2e 100%)"},children:(0,a.jsx)("div",{className:"card",style:{width:"100%",maxWidth:"400px",padding:"var(--space-2xl)"},children:(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{fontSize:"3rem",marginBottom:"var(--space-md)"},children:"⚓"}),(0,a.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:700},children:"ServicePRO"}),(0,a.jsx)("p",{style:{color:"var(--color-text-muted)",marginTop:"var(--space-lg)"},children:"Y\xfckleniyor..."})]})})})}function p(){return(0,a.jsx)(i.Suspense,{fallback:(0,a.jsx)(u,{}),children:(0,a.jsx)(m,{})})}},3909:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return n},a:function(){return s}});var a=r(7437),i=r(2265);let o=(0,i.createContext)(void 0);function n(e){let{children:t}=e,[r,n]=(0,i.useState)(null),[s,l]=(0,i.useState)(!0);async function c(){try{let e=null;if(!(e=localStorage.getItem("token"))){let t=document.cookie.match(/(^|;) ?token=([^;]*)(;|$)/);(e=t?t[2]:null)&&localStorage.setItem("token",e)}if(!e){l(!1);return}let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e.user)}else localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax",n(null)}catch(e){console.error("Auth check failed:",e),n(null)}finally{l(!1)}}async function d(e,t){let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)throw Error((await r.json()).error||"Giriş başarısız");let a=await r.json();n(a.user),localStorage.setItem("token",a.token),document.cookie="token=".concat(a.token,"; path=/; max-age=").concat(604800,"; SameSite=Lax")}async function m(){await c()}return(0,i.useEffect)(()=>{c()},[]),(0,a.jsx)(o.Provider,{value:{user:r,isAuthenticated:!!r,isLoading:s,login:d,logout:function(){n(null),localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax",fetch("/api/auth/logout",{method:"POST"}).catch(e=>console.error("Logout API error:",e))},refreshUser:m},children:t})}function s(){let e=(0,i.useContext)(o);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},6942:function(e,t,r){"use strict";r.d(t,{a:function(){return a.a}});var a=r(3909)}},function(e){e.O(0,[775,971,117,744],function(){return e(e.s=6493)}),_N_E=e.O()}]);