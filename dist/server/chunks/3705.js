exports.id=3705,exports.ids=[3705],exports.modules={87529:()=>{},53560:(e,t,r)=>{"use strict";r.d(t,{y:()=>E});var a=r(97816);let s={toBoolean:e=>"TRUE"===e.toUpperCase(),toDate:e=>{if(!e)return null;let t=e.split(".");if(3!==t.length)return null;let r=new Date(parseInt(t[2]),parseInt(t[1])-1,parseInt(t[0]));return isNaN(r.getTime())?null:r},toDateTime:e=>{if(!e)return null;let t=new Date(e);return isNaN(t.getTime())?null:t},toNumber:e=>{if(!e)return null;let t=parseFloat(e);return isNaN(t)?null:t},toEnum:(e,t)=>t[e.toUpperCase().replace(/ /g,"_")]||null},n={RANDEVU_VERİLDİ:"RANDEVU_VERILDI",RANDEVUV:"RANDEVU_VERILDI",DEVAM_EDİYOR:"DEVAM_EDIYOR",DEVAM:"DEVAM_EDIYOR",PARCA_BEKLIYOR:"PARCA_BEKLIYOR",PARCA:"PARCA_BEKLIYOR",MÜŞTERİ_ONAY_BEKLIYOR:"MUSTERI_ONAY_BEKLIYOR",MUSTERI:"MUSTERI_ONAY_BEKLIYOR",RAPOR_BEKLIYOR:"RAPOR_BEKLIYOR",RAPOR:"RAPOR_BEKLIYOR",KEŞİF_KONTROL:"KESIF_KONTROL",KESIF:"KESIF_KONTROL",TAMAMLANDI:"TAMAMLANDI",TAMAM:"TAMAMLANDI"},i={PAKET:"PAKET","PAKET İŞ":"PAKET",ARIZA:"ARIZA","ARIZA/KEŞİF":"ARIZA",PROJE:"PROJE","PROJE/REFİT":"PROJE"},o={USTA:"usta",USTABAŞI:"usta",TEKNISYEN:"usta",ÇIRAK:"cirak",CIRAK:"cirak",YÖNETİCİ:"yonetici",YONETICI:"yonetici",OFİS:"ofis",OFIS:"ofis"},u={TEKNİSYEN:"teknisyen",TEKNISYEN:"teknisyen",YETKİLİ:"yetkili",YETKILI:"yetkili",YÖNETİCİ:"yetkili",YONETICI:"yetkili"},l={SORUMLU:"SORUMLU","SORUMLU \xc7ALIŞAN":"SORUMLU",DESTEK:"DESTEK","DESTEK \xc7ALIŞAN":"DESTEK"},m={ALTIN:"ALTIN",GÜMÜŞ:"GUMUS",GUMUS:"GUMUS",BRONZ:"BRONZ"};function d(e,t,r,a,s={}){return{dbField:e,sheetColumn:t,type:r,required:a,enumValues:s.enumValues,transform:s.transform}}let c={PLANLAMA:{sheetName:"DB_Planlama",range:"A:R",primaryKey:"id",syncStrategy:"DB_FIRST",enableSoftDelete:!0,timestamps:{createdAt:"olusturmaTarihi",updatedAt:"guncellestirmeTarihi",deletedAt:"silinmis"},columns:[d("id","A","string",!0),d("tarih","B","date",!0,{transform:s.toDate}),d("saat","C","string",!1),d("tekneAdi","D","string",!0),d("adres","E","string",!0),d("yer","F","string",!1),d("servisAciklamasi","G","string",!0),d("irtibatKisi","H","string",!1),d("telefon","I","string",!1),d("durum","J","enum",!0,{enumValues:n,transform:e=>s.toEnum(e,n)}),d("kapanisDurumu","K","string",!1),d("kapanisId","L","string",!1),d("kapanisYapan","M","string",!1),d("olusturan","N","string",!1),d("olusturmaTarihi","O","datetime",!1,{transform:s.toDateTime}),d("guncellestirmeTarihi","P","datetime",!1,{transform:s.toDateTime}),d("silinmis","Q","boolean",!1,{transform:s.toBoolean})]},PERSONEL:{sheetName:"Personel_Listesi",range:"A:M",primaryKey:"id",syncStrategy:"DB_FIRST",enableSoftDelete:!1,timestamps:{createdAt:"olusturmaTarihi",updatedAt:"guncellestirmeTarihi"},columns:[d("id","A","string",!0),d("ad","B","string",!0),d("unvan","C","enum",!0,{enumValues:o,transform:e=>s.toEnum(e,o)}),d("rol","D","string",!0,{transform:e=>u[e.toUpperCase()]||e.toLowerCase()}),d("aktif","E","boolean",!0,{transform:s.toBoolean}),d("girisYili","F","number",!1,{transform:s.toNumber}),d("telefon","G","string",!1),d("email","H","string",!1),d("adres","I","string",!1),d("aciklama","J","string",!1),d("olusturmaTarihi","K","datetime",!1,{transform:s.toDateTime}),d("guncellestirmeTarihi","L","datetime",!1,{transform:s.toDateTime})]},TEKNELER:{sheetName:"Tekneler",range:"A:R",primaryKey:"id",syncStrategy:"DB_FIRST",enableSoftDelete:!1,timestamps:{createdAt:"olusturmaTarihi",updatedAt:"guncellestirmeTarihi"},columns:[d("id","A","string",!0),d("ad","B","string",!0),d("seriNo","C","string",!1),d("marka","D","string",!1),d("model","E","string",!1),d("boyut","F","number",!1,{transform:s.toNumber}),d("motorTipi","G","string",!1),d("motorSeriNo","H","string",!1),d("yil","I","number",!1,{transform:s.toNumber}),d("renk","J","string",!1),d("mulkiyet","K","string",!1),d("adres","L","string",!1),d("telefon","M","string",!1),d("email","N","string",!1),d("aciklama","O","string",!1),d("aktif","P","boolean",!0,{transform:s.toBoolean}),d("olusturmaTarihi","Q","datetime",!1,{transform:s.toDateTime})]},PUANLAMA:{sheetName:"Puanlama",range:"A:N",primaryKey:"id",syncStrategy:"DB_FIRST",enableSoftDelete:!1,timestamps:{createdAt:"tarih",updatedAt:"tarih"},columns:[d("id","A","string",!0),d("servisId","B","string",!0),d("personelId","C","string",!0),d("personelAd","D","string",!0),d("rol","E","enum",!0,{enumValues:l,transform:e=>l[e.toUpperCase()]||e}),d("isTuru","F","enum",!0,{enumValues:i,transform:e=>s.toEnum(e,i)}),d("raporBasarisi","G","number",!1,{transform:s.toNumber}),d("hamPuan","H","number",!1,{transform:s.toNumber}),d("zorlukCarpani","I","number",!1,{transform:s.toNumber}),d("finalPuan","J","number",!1,{transform:s.toNumber}),d("bonus","K","boolean",!1,{transform:s.toBoolean}),d("notlar","L","string",!1),d("tarih","M","datetime",!1,{transform:s.toDateTime})]},AYLIK_OZET:{sheetName:"Aylik_Ozet",range:"A:N",primaryKey:"id",syncStrategy:"DB_FIRST",enableSoftDelete:!1,timestamps:{createdAt:"olusturmaTarihi",updatedAt:"guncellestirmeTarihi"},columns:[d("id","A","string",!0),d("personelId","B","string",!0),d("personelAd","C","string",!0),d("ay","D","string",!0),d("servisSayisi","E","number",!1,{transform:s.toNumber}),d("sorumluServis","F","number",!1,{transform:s.toNumber}),d("destekServis","G","number",!1,{transform:s.toNumber}),d("bireyselPuanOrt","H","number",!1,{transform:s.toNumber}),d("yetkiliPuanOrt","I","number",!1,{transform:s.toNumber}),d("ismailPuani","J","number",!1,{transform:s.toNumber}),d("toplamPuan","K","number",!1,{transform:s.toNumber}),d("siralama","L","number",!1,{transform:s.toNumber}),d("rozet","M","enum",!1,{enumValues:m,transform:e=>m[e.toUpperCase()]||null})]}},p={PLANLAMA:"DB_Planlama",PERSONEL:"Personel_Listesi",TEKNELER:"Tekneler",PUANLAMA:"Puanlama",AYLIK_OZET:"Aylik_Ozet"};p.PLANLAMA,p.PERSONEL,p.TEKNELER,p.PUANLAMA,p.AYLIK_OZET;class A{constructor(e,t,r){this.syncHistory=[],this.auth=new a.lkr.auth.JWT({email:e,key:t.replace(/\\n/g,"\n"),scopes:["https://www.googleapis.com/auth/spreadsheets"]}),this.spreadsheetId=r}async syncAllFromSheets(){let e={},t=Date.now();for(let[r,a]of Object.entries(c))try{e[r]=await this.syncFromSheets(r)}catch(s){e[r]={success:!1,created:0,updated:0,deleted:0,skipped:0,errors:[{type:"SYNC_ERROR",message:s instanceof Error?s.message:"Unknown error",rowId:void 0}],timestamp:new Date,durationMs:Date.now()-t,sheetName:a.sheetName,syncType:"FULL"}}return e}async syncFromSheets(e){let t=Date.now(),r=c[e];if(!r)return{success:!1,created:0,updated:0,deleted:0,skipped:0,errors:[{type:"CONFIG_ERROR",message:`Unknown sheet: ${e}`,rowId:void 0}],timestamp:new Date,durationMs:Date.now()-t,sheetName:e,syncType:"FULL"};try{let a=await this.readSheetData(r.sheetName,r.range);if(!a||0===a.length)return{success:!0,created:0,updated:0,deleted:0,skipped:0,errors:[],timestamp:new Date,durationMs:Date.now()-t,sheetName:r.sheetName,syncType:"FULL"};let s=await this.processSheetRows(e,r,a);return s.durationMs=Date.now()-t,s}catch(e){return{success:!1,created:0,updated:0,deleted:0,skipped:0,errors:[{type:"SYNC_ERROR",message:e instanceof Error?e.message:"Unknown error",rowId:void 0}],timestamp:new Date,durationMs:Date.now()-t,sheetName:r.sheetName,syncType:"FULL"}}}async processSheetRows(e,t,r){let a=0,s=0,n=0,i=0,o=[];for(let u of r.slice(1))try{switch(await this.processSingleRow(e,t,u)){case"created":a++;break;case"updated":s++;break;case"deleted":n++;break;case"skipped":i++}}catch(e){o.push({type:"ROW_ERROR",message:e instanceof Error?e.message:"Unknown error",rowId:u[0]?.toString()})}return{success:0===o.length,created:a,updated:s,deleted:n,skipped:i,errors:o,timestamp:new Date,durationMs:0,sheetName:t.sheetName,syncType:"FULL"}}async processSingleRow(e,t,r){let a=r[0];if(!a)return"skipped";let s=t.timestamps.deletedAt?this.getCellValue(r,t,t.timestamps.deletedAt):null;if(s&&"TRUE"===s.toString().toUpperCase())return await this.softDeleteRecord(e,a.toString()),"deleted";let n=this.transformRowData(t,r);return await this.upsertRecord(e,a.toString(),n),"updated"}transformRowData(e,t){let r={};for(let a of e.columns){let n=this.getCellValue(t,e,a.sheetColumn);if(null==n||""===n){a.required&&(r[a.dbField]=this.getDefaultValue(a.type));continue}switch(a.type){case"string":r[a.dbField]=n.toString();break;case"number":r[a.dbField]=s.toNumber(n.toString());break;case"boolean":r[a.dbField]=s.toBoolean(n.toString());break;case"date":r[a.dbField]=s.toDate(n.toString());break;case"enum":r[a.dbField]=this.transformEnum(n.toString(),a.enumValues||{});break;default:r[a.dbField]=n}}let a=new Date;if(e.timestamps.createdAt){let n=this.getCellValue(t,e,e.timestamps.createdAt);r.createdAt=n?s.toDate(n.toString()):a}return e.timestamps.updatedAt&&(r.updatedAt=a),r}getCellValue(e,t,r){return e[r.charCodeAt(0)-65]}transformEnum(e,t){return t[e.toUpperCase().trim()]||null}getDefaultValue(e){switch(e){case"string":return"";case"number":return 0;case"boolean":return!1;default:return null}}async upsertRecord(e,t,a){let{PrismaClient:s}=await Promise.resolve().then(r.t.bind(r,53524,23)),n=new s;switch(e){case"PLANLAMA":await n.service.upsert({where:{id:t},update:a,create:a});break;case"PERSONEL":await n.personel.upsert({where:{id:t},update:a,create:a});break;case"TEKNELER":await n.tekne.upsert({where:{id:t},update:a,create:a});break;case"PUANLAMA":await n.servisPuan.upsert({where:{id:t},update:a,create:a});break;case"AYLIK_OZET":await n.aylikPerformans.upsert({where:{id:t},update:a,create:a})}}async softDeleteRecord(e,t){let{PrismaClient:a}=await Promise.resolve().then(r.t.bind(r,53524,23)),s=new a;switch(e){case"PLANLAMA":await s.service.update({where:{id:t},data:{deletedAt:new Date}});break;case"PERSONEL":await s.personel.update({where:{id:t},data:{deletedAt:new Date}});break;case"TEKNELER":await s.tekne.update({where:{id:t},data:{deletedAt:new Date}});break;case"PUANLAMA":await s.servisPuan.delete({where:{id:t}});break;case"AYLIK_OZET":await s.aylikPerformans.delete({where:{id:t}})}}async readSheetData(e,t){let r=a.lkr.sheets({version:"v4",auth:this.auth});return(await r.spreadsheets.values.get({spreadsheetId:this.spreadsheetId,range:`${e}!${t}`})).data.values||[]}async writeToSheet(e,t,r){let s=a.lkr.sheets({version:"v4",auth:this.auth});await s.spreadsheets.values.update({spreadsheetId:this.spreadsheetId,range:`${e}!${t}`,valueInputOption:"USER_ENTERED",requestBody:{values:r}})}async appendToSheet(e,t){let r=a.lkr.sheets({version:"v4",auth:this.auth});await r.spreadsheets.values.append({spreadsheetId:this.spreadsheetId,range:`${e}!A:A`,valueInputOption:"USER_ENTERED",requestBody:{values:[t]}})}getSyncHistory(){return this.syncHistory}async logSync(e,t){let{PrismaClient:a}=await Promise.resolve().then(r.t.bind(r,53524,23)),s=new a;await s.syncLog.create({data:{sheetName:e,syncType:t.syncType,status:t.success?"SUCCESS":t.errors.length>0?"PARTIAL":"FAILED",recordsCreated:t.created,recordsUpdated:t.updated,recordsDeleted:t.deleted,durationMs:t.durationMs,errors:JSON.stringify(t.errors)}})}}async function E(){let e=process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL,t=process.env.GOOGLE_PRIVATE_KEY,r=process.env.GOOGLE_SPREADSHEET_ID;return e&&t&&r?new A(e,t,r):(console.error("Missing Google Sheets credentials"),null)}}};